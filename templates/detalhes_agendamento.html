{% extends 'base.html' %}

{% block title %}Detalhes do Agendamento{% endblock %}

{% block head %}
{{ super() }}

{% endblock %}

{% block content %}
<div class="details-wrapper">
    <h1>Detalhes do Agendamento #{{ agendamento.id }}</h1>

    {% if agendamento %}
    <div class="details-row">
        <span class="details-label">Título:</span>
        <span class="details-value">{{ agendamento.tipo_nome }} - {{ agendamento.unidade_nome }} ({{
            agendamento.empreendimento_nome }})</span>
    </div>
    <div class="details-row">
        <span class="details-label">Status:</span>
        <span class="details-value">{{ agendamento.status }}</span>
    </div>
    <div class="details-row">
        <span class="details-label">Data:</span>
        <span class="details-value">{{ data_formatada }}</span>
    </div>
    <div class="details-row">
        <span class="details-label">Hora:</span>
        <span class="details-value">{{ agendamento.hora }} (Duração: {{ agendamento.duracao_minutos }} min)</span>
    </div>
    <div class="details-row">
        <span class="details-label">Serviço:</span>
        <span class="details-value">{{ agendamento.tipo_nome }}</span>
    </div>
    <div class="details-row">
        <span class="details-label">Local:</span>
        <span class="details-value">{{ agendamento.unidade_nome }} ({{ agendamento.empreendimento_nome }})</span>
    </div>
    <div class="details-row">
        <span class="details-label">Observações:</span>
        <span class="details-value">{{ agendamento.observacoes if agendamento.observacoes else 'N/A' }}</span>
    </div>

    <hr>

    <h2>Informações do Cliente</h2>
    <div class="details-row">
        <span class="details-label">Nome:</span>
        <span class="details-value">{{ agendamento.cliente_nome }}</span>
    </div>

    {# Exibir informações sensíveis do cliente apenas para Agentes e Administradores #}
    {% if is_admin or is_agente %}
    <div class="details-row">
        <span class="details-label">Contato:</span>
        <span class="details-value">{{ agendamento.contato_agendamento if agendamento.contato_agendamento else 'Não
            informado' }}</span>
    </div>
    <div class="details-row">
        <span class="details-label">E-mail:</span>
        <span class="details-value">{{ agendamento.cliente_email if agendamento.cliente_email else 'Não informado'
            }}</span>
    </div>
    <div class="details-row">
        <span class="details-label">Telefone (cadastro):</span>
        <span class="details-value">{{ agendamento.cliente_telefone if agendamento.cliente_telefone else 'Não informado'
            }}</span>
    </div>
    {% else %}
    <div class="details-row">
        <span class="details-label">Contato:</span>
        <span class="details-value">Disponível para Agentes e Administradores</span>
    </div>
    <div class="details-row">
        <span class="details-label">E-mail:</span>
        <span class="details-value">Disponível para Agentes e Administradores</span>
    </div>
    {% endif %}

    <hr>

    <h2>Informações do Agente Atribuído</h2>
    <div class="details-row">
        <span class="details-label">Nome:</span>
        <span class="details-value">{{ agendamento.agente_nome if agendamento.agente_nome else 'Não atribuído' }}</span>
    </div>
    {# Exibir e-mail do agente atribuído apenas para Administradores #}
    {% if is_admin %}
    <div class="details-row">
        <span class="details-label">E-mail:</span>
        <span class="details-value">{{ agendamento.agente_email if agendamento.agente_email else 'Não informado'
            }}</span>
    </div>
    {% endif %}

    <a href="{{ url_for('calendario') }}" class="back-link">← Voltar ao Calendário</a>

    {% else %}
    <p>Não foi possível carregar os detalhes do agendamento.</p>
    <a href="{{ url_for('calendario') }}" class="back-link">← Voltar ao Calendário</a>
    {% endif %}
</div>
{% endblock %}