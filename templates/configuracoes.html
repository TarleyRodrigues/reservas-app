{% extends 'base.html' %}

{% block content %}
<div class="config-container">
    <h1>Configurações do Sistema</h1>

    <!-- Tipos de Agendamento -->
    <div class="config-section">
        <h2>Tipos de Agendamento</h2>
        <form method="POST" action="{{ url_for('adicionar_tipo') }}">
            <input type="text" name="novo_tipo" placeholder="Novo tipo" required>
            <button type="submit" class="btn-add">Adicionar</button>
        </form>

        <ul class="config-list">
            {% for tipo in tipos %}
            <li>
                {{ tipo.nome }}
                <form method="POST" action="{{ url_for('remover_tipo', tipo_id=tipo.id) }}" style="display:inline;">
                    <button type="submit" class="btn-remove">Remover</button>
                </form>
            </li>
            {% endfor %}
        </ul>
    </div>

    <!-- Empreendimentos -->
    <div class="config-section">
        <h2>Empreendimentos</h2>
        <form method="POST" action="{{ url_for('adicionar_empreendimento') }}">
            <input type="text" name="nome" placeholder="Novo empreendimento" required>
            <button type="submit" class="btn-add">Adicionar</button>
        </form>

        <ul class="config-list">
            {% for empreendimento in empreendimentos %}
            <li>
                {{ empreendimento.nome }}
                <form method="POST" action="{{ url_for('toggle_empreendimento') }}" style="display:inline;">
                    <input type="hidden" name="emp_id" value="{{ empreendimento.id }}">
                    <button type="submit" class="btn-toggle">
                        {{ 'Desativar' if empreendimento.ativo else 'Ativar' }}
                    </button>
                </form>
                <form method="POST" action="{{ url_for('remover_empreendimento', emp_id=empreendimento.id) }}"
                    style="display:inline;">
                    <button type="submit" class="btn-remove">Remover</button>
                </form>
            </li>
            {% endfor %}
        </ul>
    </div>

    <!-- Unidades -->
    <div class="config-section">
        <h2>Unidades</h2>
        <form method="POST" action="{{ url_for('adicionar_unidade') }}">
            <select name="empreendimento_id" required>
                <option value="">Selecione um empreendimento</option>
                {% for empreendimento in empreendimentos %}
                <option value="{{ empreendimento.id }}">{{ empreendimento.nome }}</option>
                {% endfor %}
            </select>
            <input type="text" name="nome" placeholder="Nova unidade" required>
            <button type="submit" class="btn-add">Adicionar</button>
        </form>

        <ul class="config-list">
            {% for unidade in unidades %}
            <li>
                {{ unidade.nome }} ({{ unidade.empreendimento }})
                <form method="POST" action="{{ url_for('toggle_unidade', unidade_id=unidade.id) }}"
                    style="display:inline;">
                    <button type="submit" class="btn-toggle">
                        {{ 'Desativar' if unidade.ativo else 'Ativar' }}
                    </button>
                </form>

            </li>
            {% endfor %}
        </ul>
    </div>
</div>

<!-- Estilo -->
<style>
    .config-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

    .config-section {
        margin-bottom: 30px;
        padding: 15px;
        background: #f9f9f9;
        border-radius: 8px;
    }

    .config-list {
        list-style: none;
        padding: 0;
    }

    .config-list li {
        padding: 10px;
        background: white;
        margin: 5px 0;
        border-radius: 4px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .btn-add,
    .btn-remove,
    .btn-toggle {
        padding: 5px 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }

    .btn-add {
        background: #4CAF50;
        color: white;
    }

    .btn-remove {
        background: #f44336;
        color: white;
    }

    .btn-toggle {
        background: #2196F3;
        color: white;
    }
</style>

<!-- Confirmação de remoção -->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        document.querySelectorAll('.btn-remove').forEach(button => {
            button.addEventListener('click', function (e) {
                if (!confirm('Tem certeza que deseja remover este item?')) {
                    e.preventDefault();
                }
            });
        });
    });
</script>
{% endblock %}